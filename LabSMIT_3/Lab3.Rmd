---
title: "Лабораторна робота № 3. Основи вибіркового методу"
author: "Лабущак Анжела"
date: "`r Sys.Date()`"
output:
  html_document:
    toc: true
    df_print: paged
  html_notebook:
    toc: true
    toc_float: true
    highlight: tango
editor_options:
  chunk_output_type: console
---

```{r setup, include=FALSE}
# Підключаємо бібліотеки для гарних таблиць та графіків
library(knitr)
library(ggplot2) # Якщо захочемо красиві графіки
```

# 1. Постановка задачі

Випадкова величина $X$ має нормальний закон розподілу $N(a, \sigma^2)$ з параметрами:
$$a = 0; \quad \sigma = 1$$
Необхідно згенерувати дві вибірки обсягом $n=100$ та $n=1000$, обчислити їх числові характеристики та побудувати графіки.

# 2. Допоміжні функції

Створимо власну функцію для розрахунку асиметрії ($A_s$) та ексцесу ($E_k$), оскільки в базовому R їх немає. Формули взяті з методичних вказівок.

```{r functions}
# Функція для розрахунку характеристик вибірки
calc_statistics <- function(x) {
  n <- length(x)
  m <- mean(x)                  # Вибіркове середнє
  s2 <- var(x)                  # Виправлена дисперсія
  s <- sd(x)                    # Виправлене квадратичне відхилення (СКВ)
  
  # Асиметрія (Skewness)
  As <- sum((x - m)^3) / (n * sqrt((n-1)/n * s2)^3)
  
  # Ексцес (Kurtosis)
  Ek <- sum((x - m)^4) / (n * ((n-1)/n * s2)^2) - 3
  
  return(c(Mean = m, Var = s2, SD = s, Skew = As, Kurt = Ek))
}
```

# 3. Дослідження вибірки n = 100

Генеруємо 100 випадкових чисел з нормальним розподілом.

```{r sample_100}
set.seed(123) # Щоб результати були однакові при кожному запуску
n1 <- 100
a <- 0
sigma <- 1

# Генерація вибірки
X1 <- rnorm(n1, mean = a, sd = sigma)

# Вивід перших елементів
head(X1)

# Розрахунок статистик
stats1 <- calc_statistics(X1)
print(stats1)
```

## Графічний аналіз (n=100)

Будуємо 4 графіки на одному екрані, як у методичці: Гістограма, Емпірична функція, Boxplot (ящик з вусами) та графік щільності.

```{r plots_100, fig.width=10, fig.height=8}
par(mfrow = c(2, 2)) # Розділити екран на 4 частини

# 1. Гістограма з теоретичною кривою
hist(X1, freq = FALSE, col = "lightblue", main = "Гістограма (n=100)", xlab = "X")
curve(dnorm(x, a, sigma), col = "red", lwd = 2, add = TRUE)

# 2. Емпірична функція розподілу
plot(ecdf(X1), main = "Емпірична функція розподілу", col = "blue", verticals = TRUE)
curve(pnorm(x, a, sigma), col = "red", lwd = 2, add = TRUE)

# 3. Ящик з вусами (Boxplot)
boxplot(X1, horizontal = TRUE, col = "lightgray", main = "Boxplot (Ящик з вусами)")

# 4. Графік щільності (Density plot)
plot(density(X1), main = "Емпірична щільність", col = "blue", lwd = 2)
curve(dnorm(x, a, sigma), col = "red", lwd = 2, lty = 2, add = TRUE)

par(mfrow = c(1, 1)) # Повернути налаштування назад
```

# 4. Дослідження вибірки n = 1000

Повторюємо те саме для великої вибірки.

```{r sample_1000}
n2 <- 1000
X2 <- rnorm(n2, mean = a, sd = sigma)

# Розрахунок статистик
stats2 <- calc_statistics(X2)
print(stats2)
```

## Графічний аналіз (n=1000)

```{r plots_1000, fig.width=10, fig.height=8}
par(mfrow = c(2, 2))

# 1. Гістограма
hist(X2, freq = FALSE, col = "lightgreen", main = "Гістограма (n=1000)", xlab = "X")
curve(dnorm(x, a, sigma), col = "red", lwd = 2, add = TRUE)

# 2. Емпірична функція розподілу
plot(ecdf(X2), main = "Емпірична функція розподілу", col = "blue", verticals = TRUE)
curve(pnorm(x, a, sigma), col = "red", lwd = 2, add = TRUE)

# 3. Boxplot
boxplot(X2, horizontal = TRUE, col = "lightgray", main = "Boxplot")

# 4. Щільність
plot(density(X2), main = "Емпірична щільність", col = "blue", lwd = 2)
curve(dnorm(x, a, sigma), col = "red", lwd = 2, lty = 2, add = TRUE)

par(mfrow = c(1, 1))
```

# 5. Підсумкова таблиця

Зводимо результати в одну таблицю для порівняння точності оцінок.

```{r final_table}
# Створюємо таблицю
results <- data.frame(
  "Характеристика" = c("Мат. сподівання (Mean)", "Дисперсія (Var)", "СКВ (SD)", "Асиметрія (Skew)", "Ексцес (Kurt)"),
  "Теоретичне" = c(0, 1, 1, 0, 0),
  "n=100" = round(stats1, 4),
  "n=1000" = round(stats2, 4)
)

# Виводимо таблицю
kable(results, caption = "Порівняння теоретичних та вибіркових характеристик")
```

# Висновки

Ми бачимо, що при збільшенні обсягу вибірки з $n=100$ до $n=1000$:
1. Гістограма стає більш гладкою і симетричною.
2. Емпіричні оцінки (середнє, дисперсія) наближаються до теоретичних значень (0 та 1).
3. Асиметрія та ексцес також прямують до нуля, що підтверджує нормальність розподілу.